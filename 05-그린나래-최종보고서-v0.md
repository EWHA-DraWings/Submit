# Team-Info
| (1) 과제명 | 노인 인지 기능 저하 예방을 위한 gpt-4o 기반 음성 챗봇 및 일기 생성 서비스
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 05-그린나래 |
| (3) 팀 구성원 | 장서연 (2171043): 리더, AI 리더, FE <br> 김여은 (2130008): 팀원, FE 리더, BE <br> 우정아 (2176223) : 팀원, BE 리더, AI         |
| (4) 팀 지도교수 | 심재형 교수님 |
| (5) 팀 멘토 | 서오석 / 리더 / 카카오스타일 |
| (6) 과제 분류 | 산학과제 |
| (6) 과제 키워드 | LLM, Gen AI, Voice Chatbot, sentiment-analysis  |
| (7) 과제 내용 요약 |   고령화 시대에 들어서며, 2050년에는 국내 노인의 16%가 치매환자가 된다고 합니다. 또한 경도인지장애(MCI)를 진단받은 사람 중 80%는 5년 이내에 치매 환자가 되며, 이는 꾸준한 인지 활동을 통해 예방할 수 있습니다. 그러나 많은 연구에서 MCI는 초기 발견이 어렵다는 결과가 있습니다. <br><br>저희는 'AI가 인지 활동과 치매 조기 진단을 도와준다면, 노인의 인지 저하를 예방할 수 있지 않을까?'라는 아이디어에서 출발하여, **AI 챗봇과의 음성 대화를 통한 일기 작성과 일기 기반의 기억점수 측정 기능을 제공하는 노인 인지 저하 예방을 위한 서비스, sodam**을 개발하였습니다. 해당 서비스를 통해 지속적인 일기 작성을 통해 하루를 회고하며 인지기능을 강화하고, 경도인지장애, 경도 치매 스크리닝 및 전문적 진료를 권유하는 역할을 통해 조기 발견 가능성을 높이고자 합니다.|

<br><br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 |**1. 배경**<br> - 노인 인구가 증가함에 따라 치매 위험군에 속하는 인구도 급격히 증가(2024년 기준 65세 이상 치매 환자수 103만명) <br> - 중앙치매센터의 2023년 자료에 따르면 개인의 연간 치매 관리 비용은 2220만원, 국가 차원의 비용은 약 21조로 GDP의 약 1%를 차지 <br> - 가족 및 돌봄 제공자에게 정신적, 육체적, 경제적 부담 가중<br><br> **2. Target Customer**<br> 노인&자녀(보호자)<br> - 고령의 부모님의 건강을 부담스럽지 않은 방식으로 모니터링하고 싶은 자녀<br> - 부모님의 꾸준한 인지 활동을 도와줄 수 있는 서비스에 관심있는 자녀<br> - 자신의 인지 능력을 유지하거나 향상시킬 수 있는 활동에 관심이 있는 노인<br><br>  **3. Pain Points**<br> **[보호자(자녀)]** <br> - 노인의 건강 상태 및 감정 변화를 모니터링하기 어려움: 보호자는 노인의 건강 상태, 감정 변화를 직접 확인하기 어려워 불안함<br> - 노인의 인지 상태에 대한 정보 부족: 노인의 인지 능력 변화나 기억력 저하를 파악하기 어렵고, 이를 효과적으로 관리하기 위한 정보가 부족<br><br> **[노인 사용자]** <br> - 기억력 감소 및 인지 퇴화: 노인은 기억력 감소 및 인지 퇴화를 자주 경험하며, 이는 치매나 인지 장애로 이어질 수 있음<br> - 정서적 고립: 사회적 상호작용이 줄어들면서 외로움을 느끼거나 정서적 지지를 받기 어려운 경우가 많음<br> - 건강 상태 모니터링의 어려움: 스스로 건강 상태를 모니터링하고 기록하는 것이 어려워, 자신의 상태를 제대로 인지하지 못할 수 있음|
| (2) 기존연구와의 비교 | 1. Audio Diary: 음성 일기 서비스<br> - 장점: 사용자 음성을 전사하여 일기에 대한 코멘트 제공<br> - 단점: 일방향적 일기 생성 과정(일기 작성 가이드라인 없음)<br><br> 2. 치매 체크: 치매 자가진단 및 뇌건강 트레이너<br> - 장점: 치매에 영향을 줄 수 있는 생활 속 요소들을 위주로 일상 생활을 스스로 모니터링 할 수 있게 해줌<br> - 단점: 직접적으로 인지 기능에 도움을 주는 활동이 없음<br><br> 3. 해피테이블: 시니어 여가 활동 증진 및 인지 능력 향상 목적의 서비스<br> - 장점: 사용자 데이터 기반으로 경도인지장애 선별 및 지속적 추적 관리 가능<br> - 단점: 게임이기 때문에 사용자의 일상, 컨디션과 무관하며 자가진단 기능이 없음<br><br> **우리 서비스(소담)**: 인지기능 향상을 위한 챗봇과의 양방향 음성 대화를 통한 일기 생성, 지속적인 기억 점수 측정을 통한 인지기능 저하 추적 관리 가능 |
| (3) 제안 내용 |- 일기 생성과 기억 테스트 과정에서 대화를 통해 일상적인 사건을 회상하게 하여 자연스러운 인지 훈련 진행<br> - 대화 중 사용자의 하루 컨디션과 감정 상태를 체크하여 제공되는 리포트를 통해 자신의 상태 이해 및 관리에 도움<br> - 노인과의 대화를 분석하여 생성된 감정 분석 결과와 컨디션 정보를 리포트로 보호자에게 제공<br> - 노인의 일기 내용을 기반으로 기억 점수 측정과 점수 변화를 통해 인지 상태 변화 파악<br> - 음성 챗봇이 친근한 대화 상대가 되어 정서적 지지를 제공하고, 일상적인 대화를 통해 외로움 감소<br>|
| (4) 기대효과 및 의의 | - **인지 기능 저하 예방 기여**: 챗봇과의 대화를 통한 일상 대화를 유도하고, 일기 생성 서비스를 통해 노인들이 자신의 생각과 감정을 기록하며 반추할 수 있는 기회를 제공 <br> - **노인들의 사회적 고립감 완화**:  노인들이 대화할 수 있는 환경을 제공하여 사회적 고립감을 줄이고, 정서적 지지를 받을 수 있도록 도움 및 자녀에게 상태를 공유하여 노인의 감정 컨디션 파악 가능 <br> - **인지 기능 변화 모니터링**: 대화 내용이나 패턴, 기억 점수 등의 데이터 축적을 통해 치매의 초기 징후를 탐지하는 데 활용 가능. |
| (5) 주요 기능 리스트 |![image](https://github.com/user-attachments/assets/b7781109-fcf5-43a0-b599-63787319ac37) 1. **음성 채팅** : 매일 설정해둔 시간에 알람을 통해 챗봇과 음성 대화를 할 수 있음.<br><br> 2. **일기 조회** : 챗봇과의 음성 대화를 바탕으로 그날의 일기가 생성.<br><br>3. **리포트 조회** : 리포트에는 그날의 감정, 컨디션, 기억점수를 보여줌. 생성된 일기를 바탕으로 그날의 감정, 컨디션을 도출하며, 기억점수의 추이도 그래프를 통해 제공하여 인지기능 저하 가능성 및 컨디션을 빠르게 파악할 수 있음.<br><br> 4. **기억점수 측정** : 3일마다 앱의 알람을 통해 기억점수를 측정하도록 유도함. 기억점수는 3일간의 일기를 바탕으로episodic memory를 잘 기억하는지 확인함. 일정 점수 이하이면 자가진단을 권유. <br><br> 5. **자가 진단** : 노인 사용자와 보호자 사용자의 자가진단 문항이 다름. 보호자는 KDSQ , 사용자는 PRMQ 자가진단을 실시함. 노인 사용자의 자가진단의 질문은 TTS로 재생되며, 자가진단을 통해 인지기능저하 가능성을 확인해볼 수 있도록 함. 자가진단 결과 또한 누적되어 기록됨. <br><br><br>[user별 사용 가능한 기능 비교]<br> ![image](https://github.com/user-attachments/assets/1784a356-d869-46b5-b628-f72fd280c697)


<br>
 
# Project-Design & Implementation
| 항목 | 내용 |
|:---  |---  |
| (1) 요구사항 정의 | **1.요구사항 명세서** <br> [05_그린나래_요구사항 명세서 (Requirements Specification).xlsx](https://github.com/user-attachments/files/17174168/05_._.Requirements.Specification.xlsx) ![스크린샷 2024-09-28 193521](https://github.com/user-attachments/assets/37af6eca-8929-43f9-b120-5e4a19dc4b27) <br><br> **1. RQ-ID**: 각 요구사항에 대한 고유 식별자<br>  - RQ-000X : 기타 요구사항 ( 로그인, 회원가입, 계정연동) <br>  - RQ-010X : ‘대화하기’ 요구사항 <br> - RQ-020X : ‘일기장’ 요구사항 <br>- RQ-030X : ‘리포트’ 요구사항 <br>- RQ-040X : ‘자가진단’ 요구사항 <br>- RQ-100X : 비기능 요구사항<br><br> **2. 기능/비기능**: 해당 요구사항이 기능인지 비기능인지 구분<br><br> **3. 요구사항명**: 요구사항의 이름<br><br> **4. 요구사항 내용**: 요구사항의 상세 설명<br><br> **5. 날짜**: 기능 개발 완료 날짜<br><br> **6. 진행 상황**: 해당 요구사항이 반영되었는지에 대한 상태 ( 반영/대기/미반영 )<br>- 반영 : 기능 구현이 100% 완료됨 <br>- 대기 : 기능 구현 중이거나 기능 개발 여부 논의 중인 상황<br>- 미반영 : 해당 기능을 반영하지 않기로 논의함<br><br><br> **2.E-R diagram** <br> ![ER-Diagram](https://github.com/user-attachments/assets/2e2e76e5-b014-4191-af91-50583a74d80b) <br>1. **ChatSession** - 사용자 간의 채팅 세션을 관리한다. `sessionid`, `messages` (메시지 배열), 그리고 `userid` (사용자 식별자)로 구성된다.<br>2. **Diary** - 사용자가 작성한 일기를 저장한다. `diaryid`, `date` (날짜), `content` (내용), `userid` (작성자), `emotion` (감정 상태), `condition` (현재 컨디션) 등의 필드가 있다.<br>3. **EmotionAnalysis** - 일기에 기록된 감정 분석 데이터를 저장한다. 이는 `diaryid`를 참조하여 연결된다.<br>4. **Report** - 사용자의 활동과 일기로부터 생성된 리포트를 저장한다. `reportid`, `date`, `diaryid`, `messages` (보고서에 포함된 메시지들), `emotion`, `conditions` 등의 정보가 포함된다.<br>5. **MemoryScore** - 사용자의 기억력 점수를 기록한다. 여기에는 `date`, `questionCnt` (질문 수), `hintCnt` (힌트 수), `correctCnt` (정답 수), `cdrScore` (인지 저하 점수) 등이 포함된다.<br>6. **Assessment** - 사용자의 평가 결과를 관리하는 테이블로, `questionnaireType`, `score`, `date`, `field` 등의 정보를 포함한다.<br>7. **GuardianUser** - 보호자 사용자 정보를 담고 있으며, 사용자의 이름, 전화번호, 주소, 직업 등 개인 정보와 노인의 이름과 연락처 정보가 포함된다.<br>8. **ElderlyUser** - 노인 사용자의 정보를 담고 있는 테이블로, `guardianid` (보호자 ID), `id`, `name`, `password` 등의 필드를 포함한다.<br><br> **3.UI 분석/ 설계 모델**.<br> 아래는 사용자가 앱을 어떻게 사용하는지 흐름을 나타낸 'user flow'이다.![image](https://github.com/user-attachments/assets/930ea73e-eb9c-4763-afe6-72793786dd2a)|
| (2) 전체 시스템 구성 | **시스템 구조도**<br> <img src="https://github.com/user-attachments/assets/ed883441-a291-492e-b9ce-52cf0b3c284b" width="90%" height="90%"/><br> **1. 클라이언트**<br> - `Flutter`: 클라이언트 개발 프레임워크로 사용<br> 1) 보호자(자녀): Flutter를 통해 보호자가 회원 정보 입력, 자가진단 및 리포트 조회 등의 기능을 사용할 수 있도록 함<br>  2) 사용자(노인): Flutter를 통해 음성 입력, 일기 생성 및 조회, 자가진단 및 기억 점수 테스트 등의 상호작용을 제공<br><br> **2. 서버**<br> 1) `Amazon EC2`<br> - 서버의 호스팅 및 확장 가능한 클라우드 컴퓨팅 인프라로 사용<br> 2) `Node.js`<br> - 일기 생성: 사용자와의 대화를 바탕으로 일기 생성<br> - 기억 점수 테스트: 지난 3일의 일기 내용을 바탕으로 생성한 문항들로 사용자에게 기억 점수 테스트를 실시<br> - 리포트 생성: 사용자와의 대화 내용을 바탕으로 사용자의 컨디션, 감정 분석 결과 등을 리포트로 제공<br> 3) `Flask`<br> - KoBERT에서 사용자의 일기를 전달받은 후 감정 분석을 진행하기 위한 서버<br> 4) `Firebase Cloud Messaging`: 사용자에게 정기적으로 일기 작성을 위한 대화를 권하는 알려주는 기능<br><br> **3. Database**<br> - `MongoDB`: 일기 데이터, 사용자 정보, 테스트 결과 등을 저장하는 비관계형(NoSQL) 데이터베이스로 사용<br><br>**4. API**<br> - `CLOVA Speech Recognition(CSR)`: 챗봇과 사용자의 대화 중 사용자의 음성을 챗봇에게 텍스트 형태로 전달 <br> - `Google Text-to-Speech`: 챗봇과 사용자의 대화 중 챗봇의 응답을 사용자에게 음성의 형태로 전달<br> - `GPT-4o`: 사용자에게 할 질문, 응답 및 일기 생성<br><br> **5. Model**<br> - `SKT Brain KoBERT`: SKT Brain에서 제공하는 BERT 기반 한국어 모델로, 사용자의 일기를 분석하여 상위 감정 3개를 추출하는 데 사용 <br><br> **6. 구조도 전체 설명** <br>사용자는 Client를 통해 사용자 인터페이스를 제공받고, Client와 상호작용하며 서비스를 이용한다. Client는 사용자로부터 입력받거나 서비스 사용 중에 쌓인 데이터와 서비스에 필요한 요청을 Server에 전송한다. Server는 필요한 데이터를 DB에서 가져오거나, API나 모델과 소통한 결과를 Client에 전달하여 사용자가 필요한 서비스를 제공한다. 이때 DB는 서비스에 필요한 모든 데이터를 관리하고, API는 AI 관련 서비스(질문 생성 및 일기/리포트 생성)과 음성과 문자간의 변환(사용자와의 음성 소통 목적)을 처리한다. 마지막으로 모델은 AI API로 처리할 수 없는 감정 분석을 진행하여 이를 Server를 통해 Client에 전달한다.<br> |
| (3) 주요엔진 및 기능 설계 | **1. 일기 생성 모듈**<br>- 기능 설명: 사용자와 챗봇 간의 대화를 바탕으로 일기를 자동으로 생성하는 모듈<br>- 기술 스택: `GPT-4o API`, `Google Cloud Text To Speech (TTS) API`, `Naver CLOVA CSR API`<br>- 구현 내용: 프롬프트 엔지니어링을 통해 최적화된 GPT-4o와의 대화로 일기를 생성하며, 감정 분석 모듈과 연동하여 사용자의 감정 상태를 저장<br>- 특징: 대화 중 사용자가 작성 중단이나 완료를 요청하면 자동으로 내용을 저장<br><br>**2. 기억 점수 평가 모듈**<br>- 기능 설명: 사용자의 기억력과 인지 능력을 평가하는 테스트를 제공하고, 결과를 저장 및 분석하는 모듈<br>- 기술 스택: `GPT-4o API`, `Google Cloud Text To Speech (TTS) API`, `Naver CLOVA CSR API`<br>- 구현 내용: 최근 3일간의 일기 내용을 기반으로 질문을 생성하고, 사용자의 답변을 분석하여 기억 점수를 산출. 결과는 데이터베이스에 저장되어 확인 가능.<br>- 특징: IQCODE와 CDR 기억점수 기준을 적용하여 객관적인 기억 점수를 제공합니다.<br><br>**3. 감정 분석 모듈**<br>- 기능 설명: 사용자의 일기를 바탕으로 감정 상태를 분석하고 기록하는 모듈<br>- 기술 스택: `Flask`, `SKT Brain KoBERT 기반 감정 분석 모델`<br>- 구현 내용: AI Hub의 감성 대화 말뭉치와 감정 분류를 위한 대화 음성 데이터셋으로 학습된 KoBERT 모델을 통해 감정을 분석하여 일기와 함께 저장<br>- 특징: 감정 상태를 시각화하여 가족이 주기적으로 확인할 수 있는 기능을 제공<br><br>**4. 데이터베이스 모듈**<br>- 기능 설명: 사용자의 일기, 기억 점수 평가 결과, 감정 분석 데이터를 저장하고 관리하는 모듈<br>- 기술 스택: `MongoDB Atlas`<br>- 구현 내용: 사용자 정보, 일기, 기억 점수, 감정 데이터를 구조화하여 안전하게 저장<br><br>>|
| (4) 주요 기능의 구현 |**1) 실시간 음성 채팅**<br> 1. 회원 가입 시 Client(노인 사용자)가 음성 채팅을 원하는 시간대를 선택하고, 해당 시간대를 DB에 저장<br> 2. 해당 시간에 Client(노인 사용자)의 휴대폰에 알람을 전송<br> 3. 메인화면의 '대화하기' 버튼을 클릭하면 client의 websocket 생성<br> 4. client는 request를 통해 server와 websocket 연결<br> 5. **gpt-4o 메세지 처리**: gpt-4o의 메세지가 google tts에 의해 음성파일로 변환되어, 서버에서 답변 텍스트와 음성 데이터 두 가지 데이터가 함께 전송됨<br> 6. client는 답변 텍스트를 채팅 화면에 렌더링하고, 음성 데이터는 재생<br> 7. **client 메세지 처리**: client의 메세지는 음성 녹음 버튼을 통해 녹음되어, binary 음성 파일 형식으로 서버에 전달 & 서버는 Naver CLOVA STT를 통해 텍스트로 변환하여 받은 메세지를 client에 전달하고, 채팅 화면에 렌더링 <br> 8. 대화 종료될 때까지 6~8 반복 <br><br> **2) 일기 조회** <br> 1. Client(노인 사용자)가 원하는 날짜 선택<br> 2. 해당 날짜의 일기를 가져오기 위한 GET 요청을 Server로 보냄<br> 3. 서버는 DB에서 해당 날짜의 일기를 검색하여 가져옴 <br> 4. Flutter(Client) TTS 기능을 활용하여 일기를 소리로 확인 가능 <br><br> **3) 리포트**<br> 1. client가 메인화면의 '리포트' 버튼을 클릭하면 서버에 리포트를 가져오기 위한 GET 요청을 보냄<br> 2. 서버에서 날짜를 확인하고, 해당 날짜의 일기가 있으나 리포트가 없는 경우 리포트 생성<br> 3. 리포트에는 감정, 컨디션, 기억 점수가 포함되며, 감정은 감정 분석을 통해 진행<br> 4. 서버에서 데이터를 client로 전송하고, client는 리포트 화면에 렌더링 <br><br> **4) 기억점수 측정** <br>1. Client (노인 사용자)가 기억점수 측정을 위한 화면 진입 <br>2. 대화 세션이 시작되고, DB에서 해당 날짜로부터 3일 전, 2일 전, 1일 전의 일기를 가져옴<br> 3. 가져온 일기를 바탕으로, 프롬프트 엔지니어링이 완료된 GPT-4o가 기억 점수 측정을 위한 질문을 생성<br> 4. 사용자가 생성된 질문에 음성으로 답변을 시작<br> 5. 사용자의 음성 데이터가 서버로 전달되고, Naver CLOVA가 이를 텍스트로 변환<br>6. 변환된 텍스트를 GPT-4o에 전달하여, 그에 대한 응답을 생성<br> 7. 생성된 응답을 Google TTS를 활용해 음성으로 변환한 후, 음성 데이터와 텍스트 데이터를 Client에 전달<br> 8. 기억 점수 측정이 완료될때까지 대화 진행<br> 9. 대화가 종료되면 기억점수 확인 가능 및 db 저장<br><br> **5) 치매 자가진단**<br> 1. Client(노인 사용자, 보호자 사용자)가 자가진단 수행<br> 2.  Client측에서 사용자의 응답을 바탕으로 자가진단 점수를 계산하여 Server측으로 넘김<br>3. db에 자가진단 결과를 저장 |
| (5) 기타 | |

<br><br>

# Evaluation
| 항목 | 내용 |
|:---  |---  |
| (1) 평가(Evaluation) | **1. 평가 항목 설명 및 선정 이유** <br> **1) 음성 대화**<br> - **설명**<br>음성을 통해 대화를 진행하며 사용자가 텍스트를 입력하지 않아도 손쉽게 일기를 작성할 수 있는 기능으로, 자연스러운 대화 흐름과 음성-텍스트 변환(STT) 및 텍스트-음성 변환(TTS)의 품질을 평가합니다. <br> - **선정 사유**<br> 서비스의 타겟인 노인 사용자는 직접적인 텍스트 입력보다 음성 인터페이스를 선호할 가능성이 높습니다. 서비스의 핵심 기능인 일기 작성이 음성 대화로 이루어지므로 이를 평가 항목으로 선정하였습니다. <br><br> **2) 일기 생성**<br> - **설명**<br>사용자와의 대화를 바탕으로 일기를 생성해내는지 평가합니다. <br> - **선정 사유**<br>대화 내용이 효과적으로 요약되고 기록되는지 평가함으로써 서비스의 실용성을 확인하기 위해 선정하였습니다. <br><br> **3) 질문 생성**<br> - **설명**<br>사용자 답변에 따라 적절하고 자연스러운 질문을 생성하는지와 사용자가 하루를 되돌아볼 수 있도록 유도하는 질문, 기억 점수 측정을 위한 적합한 질문들을 생성해내는지 평가합니다. <br> - **선정 사유**<br>질문이 프롬프트를 잘 반영하지 않으면 서비스의 주요한 목표인 인지 훈련이 제대로 진행되지 않을 수 있기 때문에 평가 항목으로 선정하였습니다.  <br><br> **4) 접근성**<br> - **설명**<br> 노인 사용자가 앱을 보다 편리하게 사용할 수 있는 기능을 제공하는지 글자 크기, 보조 기능 제공 등의 여부를 평가합니다. <br> - **선정 사유**<br>서비스의 타겟인 노인 사용자층은 디지털 기기에 익숙하지 않을 가능성이 크므로, 평가 항목으로 선정하였습니다. <br><br>  **2. 평가 및 평가 결과** <br>Excel 파일 : [졸프_평가 항목.xlsx](https://github.com/user-attachments/files/18072643/_.xlsx) <br><br> ![image](https://github.com/user-attachments/assets/a1ff801f-17d7-4f05-84f2-aff09a4782a9)| 



<br><br>

# Conclusion
| 항목 | 내용 |
|:---  |---  |
| (1) 결론(Conclusion) | 소담은 노년층의 인지 기능을 보호하고 건강한 삶을 유지하도록 지원하는 데 그 핵심 가치를 두고 있습니다. 특히 고령층의 인지 기능 저하를 초기에 모니터링하고 이를 예방할 수 있는 시스템을 통해, 사용자들이 더 오랜 기간 동안 활기차고 독립적인 삶을 누릴 수 있도록 돕습니다. 현재 서비스는 일상적인 대화를 통해 기억력, 사고력, 언어 능력을 자연스럽게 자극하여 인지 기능 향상을 도모합니다. <br> 고령화 사회에서 인지 기능 저하는 개인뿐 아니라 가족과 사회 전체에 큰 영향을 미칩니다. 이에 소담은 이를 미리 관리하고 예방할 수 있는 서비스를 만들기 위해 기획되었습니다. 앞으로 과학적 연구와의 협업을 통해 대화 내용과 패턴을 분석하여 인지 저하의 초기 신호를 감지하고, 이를 가족이나 의료 전문가와 연결하는 시스템을 구축할 계획입니다. 사용자 피드백과 데이터를 바탕으로 서비스의 기능을 지속적으로 발전시키고, 더욱 정밀한 시스템을 개발하고자 노력할 것입니다. 소담은 기술을 통해 사람과 사람을 잇는 따뜻한 소통의 도구이자, 노년층의 건강한 미래를 설계하는 중요한 파트너가 되고자 합니다.| 


