
# Team-Info
| (1) 과제명 | 노인 인지 기능 저하 예방을 위한 gpt-4o 기반 음성 챗봇 및 일기 생성 서비스
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 05-그린나래 |
| (3) 팀 구성원 | 장서연 (2171043): 리더, AI 리더, FE <br> 김여은 (2130008): 팀원, FE 리더, BE <br> 우정아 (2176223) : 팀원, BE 리더, AI         |
| (4) 팀 지도교수 | 심재형 교수님 |
| (5) 팀 멘토 | 서오석 / 리더 / 카카오스타일 |
| (6) 과제 분류 | 산학과제 |
| (6) 과제 키워드 | LLM, Gen AI, Voice Chatbot, sentiment-analysis  |
| (7) 과제 내용 요약 | Sodam은 노인분들의 인지 기능 저하 예방을 목적으로 일기 생성, 기억점수 측정 등의 기능을 제공하는 앱 서비스입니다. <br><br> [페인포인트]<br> - 노인의 건강 상태 및 감정 변화를 모니터링하기 어려움<br> - 노인의 인지 상태에 대한 정보 부족 & 노인 분들 기억력 감소 및 인지 퇴화<br> - 정서적 고립 경험 <br><br> [타겟 유저]<br> - 부모님의 건강을 지나치게 부담스럽지 않은 방식으로 모니터링 하기를 원하고 부모님의 꾸준한 인지 활동을 도와줄 수 있는 서비스에 관심이 있는 자녀<br> - 자신의 인지 능력을 유지하거나 향상시킬 수 있는 활동에 대해 관심이 있는 65세 이상 노인  <br><br> [기대효과]<br> - 치매 예방 기여<br> - 노인들의 사회적 고립감 완화<br> - 인지 기능 변화 모니터링<br> |

<br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 |**1. 배경**<br> 노인 인구가 증가함에 따라 치매 위험군에 속하는 인구도 급격히 증가(2024년 기준 65세 이상 치매 환자수 103만명) & 가족 및 돌봄 제공자에게 정신적, 육체적, 경제적 부담 가중<br><br> **2. Target Customer**<br> - 고령의 부모님의 건강을 부담스럽지 않은 방식으로 모니터링하고 싶은 자녀<br> - 부모님의 꾸준한 인지 활동을 도와줄 수 있는 서비스에 관심있는 자녀<br> - 자신의 인지 능력을 유지하거나 향상시킬 수 있는 활동에 관심이 있는 노인<br><br>  **3. Pain Points**<br> **[보호자(자녀)]** <br> - 노인의 건강 상태 및 감정 변화를 모니터링하기 어려움: 보호자는 노인의 건강 상태, 감정 변화를 직접 확인하기 어려워 불안함<br> - 노인의 인지 상태에 대한 정보 부족: 노인의 인지 능력 변화나 기억력 저하를 파악하기 어렵고, 이를 효과적으로 관리하기 위한 정보가 부족<br><br> **[노인 사용자]** <br> - 기억력 감소 및 인지 퇴화: 노인은 기억력 감소 및 인지 퇴화를 자주 경험하며, 이는 치매나 인지 장애로 이어질 수 있음<br> - 정서적 고립: 사회적 상호작용이 줄어들면서 외로움을 느끼거나 정서적 지지를 받기 어려운 경우가 많음<br> - 건강 상태 모니터링의 어려움: 스스로 건강 상태를 모니터링하고 기록하는 것이 어려워, 자신의 상태를 제대로 인지하지 못할 수 있음|
| (2) 기존연구와의 비교 | 1. Audio Diary: 음성 일기 서비스<br> - 장점: 사용자 음성을 전사하여 일기에 대한 코멘트 제공<br> - 단점: 일방향적 일기 생성 과정(일기 작성 가이드라인 없음)<br><br> 2. 치매 체크: 치매 자가진단 및 뇌건강 트레이너<br> - 장점: 치매에 영향을 줄 수 있는 생활 속 요소들을 위주로 일상 생활을 스스로 모니터링 할 수 있게 해줌<br> - 단점: 직접적으로 인지 기능에 도움을 주는 활동이 없음<br><br> 3. 해피테이블: 시니어 여가 활동 증진 및 인지 능력 향상 목적의 서비스<br> - 장점: 사용자 데이터 기반으로 경도인지장애 선별 및 지속적 추적 관리 가능<br> - 단점: 게임이기 때문에 사용자의 일상, 컨디션과 무관하며 자가진단 기능이 없음<br><br> **우리 서비스(소담)**: 인지기능 향상을 위한 챗봇과의 양방향 음성 대화를 통한 일기 생성, 지속적인 기억 점수 측정을 통한 인지기능 저하 추적 관리 가능 |
| (3) 제안 내용 |- 일기 생성과 기억 테스트 과정에서 대화를 통해 일상적인 사건을 회상하게 하여 자연스러운 인지 훈련 진행<br> - 대화 중 사용자의 하루 컨디션과 감정 상태를 체크하여 제공되는 리포트를 통해 자신의 상태 이해 및 관리에 도움<br> - 노인과의 대화를 분석하여 생성된 감정 분석 결과와 컨디션 정보를 리포트로 보호자에게 제공<br> - 노인의 일기 내용을 기반으로 기억 점수 측정과 점수 변화를 통해 인지 상태 변화 파악<br> - 음성 챗봇이 친근한 대화 상대가 되어 정서적 지지를 제공하고, 일상적인 대화를 통해 외로움 감소<br>|
| (4) 기대효과 및 의의 | - **인지 기능 저하 예방 기여**: 챗봇과의 대화를 통한 일상 대화를 유도하고, 일기 생성 서비스를 통해 노인들이 자신의 생각과 감정을 기록하며 반추할 수 있는 기회를 제공 <br> - **노인들의 사회적 고립감 완화**:  노인들이 대화할 수 있는 환경을 제공하여 사회적 고립감을 줄이고, 정서적 지지를 받을 수 있도록 도움 및 자녀에게 상태를 공유하여 노인의 감정 컨디션 파악 가능 <br> - **인지 기능 변화 모니터링**: 대화 내용이나 패턴, 기억 점수 등의 데이터 축적을 통해 치매의 초기 징후를 탐지하는 데 활용 가능 |
| (5) 주요 기능 리스트 |1. **음성 채팅** : 매일 설정해둔 시간에 알람을 통해 챗봇과 음성 대화를 할 수 있음.<br><br> 2. **일기 조회** : 챗봇과의 음성 대화를 바탕으로 그날의 일기가 생성.<br><br>3. **리포트 조회** : 리포트에는 그날의 감정, 컨디션, 기억점수를 보여줌. 생성된 일기를 바탕으로 그날의 감정, 컨디션을 도출하며, 기억점수의 추이도 그래프를 통해 제공하여 인지기능 저하 가능성 및 컨디션을 빠르게 파악할 수 있음.<br><br> 4. **기억점수 측정** : 3일마다 앱의 알람을 통해 기억점수를 측정하도록 유도함. 기억점수는 3일간의 일기를 바탕으로episodic memory를 잘 기억하는지 확인함. 일정 점수 이하이면 자가진단을 권유. <br><br> 5. **자가 진단** : 노인 사용자와 보호자 사용자의 자가진단 문항이 다름. 보호자는 KDSQ , 사용자는 PRMQ 자가진단을 실시함. 노인 사용자의 자가진단의 질문은 TTS로 재생되며, 자가진단을 통해 인지기능저하 가능성을 확인해볼 수 있도록 함. 자가진단 결과 또한 누적되어 기록됨. <br><br><br>노인 사용자와 보호자 사용자는 사용 가능한 기능의 범위가 다르며, 아래의 표를 통해 정리하였다.<br> ![image](https://github.com/user-attachments/assets/daadd4fc-2ea3-4d3b-83f9-42ccfdb70df9)


<br><br>
 
# Project-Design
| 항목 | 내용 |
|:---  |---  |
| (1) 요구사항 정의 | *프로젝트를 완성하기 위해 필요한 요구사항을 설명하기에 가장 적합한 방법을 선택하여 기술* <br> 예) <br> - 기능별 상세 요구사항(또는 유스케이스) <br> - 설계 모델(클래스 다이어그램, 클래스 및 모듈 명세서) <br> - UI 분석/설계 모델 <br> - E-R 다이어그램/DB 설계 모델(테이블 구조)<br><br> **1.요구사항 명세서** <br> [05_그린나래_요구사항 명세서 (Requirements Specification).xlsx](https://github.com/user-attachments/files/17174168/05_._.Requirements.Specification.xlsx) ![스크린샷 2024-09-28 193521](https://github.com/user-attachments/assets/37af6eca-8929-43f9-b120-5e4a19dc4b27) <br><br> **1. RQ-ID**: 각 요구사항에 대한 고유 식별자<br>  - RQ-000X : 기타 요구사항 ( 로그인, 회원가입, 계정연동) <br>  - RQ-010X : ‘대화하기’ 요구사항 <br> - RQ-020X : ‘일기장’ 요구사항 <br>- RQ-030X : ‘리포트’ 요구사항 <br>- RQ-040X : ‘자가진단’ 요구사항 <br>- RQ-100X : 비기능 요구사항<br><br> **2. 기능/비기능**: 해당 요구사항이 기능인지 비기능인지 구분<br><br> **3. 요구사항명**: 요구사항의 이름<br><br> **4. 요구사항 내용**: 요구사항의 상세 설명<br><br> **5. 날짜**: 기능 개발 완료 날짜<br><br> **6. 진행 상황**: 해당 요구사항이 반영되었는지에 대한 상태 ( 반영/대기/미반영 )<br>- 반영 : 기능 구현이 100% 완료됨 <br>- 대기 : 기능 구현 중이거나 기능 개발 여부 논의 중인 상황<br>- 미반영 : 해당 기능을 반영하지 않기로 논의함<br><br>현재 대부분의 요구사항이 반영된 상태이며, 과거 리포트 살펴보기 와 챗봇 비기능의 유용성은 아직 개발 및 확인중에 있다.<br><br><br> **2.E-R diagram** <br> ![ER-Diagram](https://github.com/user-attachments/assets/2e2e76e5-b014-4191-af91-50583a74d80b) <br>1. **ChatSession** - 사용자 간의 채팅 세션을 관리한다. `sessionid`, `messages` (메시지 배열), 그리고 `userid` (사용자 식별자)로 구성된다.<br>2. **Diary** - 사용자가 작성한 일기를 저장한다. `diaryid`, `date` (날짜), `content` (내용), `userid` (작성자), `emotion` (감정 상태), `condition` (현재 컨디션) 등의 필드가 있다.<br>3. **EmotionAnalysis** - 일기에 기록된 감정 분석 데이터를 저장한다. 이는 `diaryid`를 참조하여 연결된다.<br>4. **Report** - 사용자의 활동과 일기로부터 생성된 리포트를 저장한다. `reportid`, `date`, `diaryid`, `messages` (보고서에 포함된 메시지들), `emotion`, `conditions` 등의 정보가 포함된다.<br>5. **MemoryScore** - 사용자의 기억력 점수를 기록한다. 여기에는 `date`, `questionCnt` (질문 수), `hintCnt` (힌트 수), `correctCnt` (정답 수), `cdrScore` (인지 저하 점수) 등이 포함된다.<br>6. **Assessment** - 사용자의 평가 결과를 관리하는 테이블로, `questionnaireType`, `score`, `date`, `field` 등의 정보를 포함한다.<br>7. **GuardianUser** - 보호자 사용자 정보를 담고 있으며, 사용자의 이름, 전화번호, 주소, 직업 등 개인 정보와 노인의 이름과 연락처 정보가 포함된다.<br>8. **ElderlyUser** - 노인 사용자의 정보를 담고 있는 테이블로, `guardianid` (보호자 ID), `id`, `name`, `password` 등의 필드를 포함한다.<br>9. **Push** - 푸시 알림 관련 정보를 관리한다. 사용자가 설정한 시간에 알람을 보내기 위한 테이블이다. `pushid`, `userid`, `guardianid`, `time`, `minute`, `hour` 등의 필드가 포함된다.<br><br><br> **3.UI 분석/ 설계 모델**.<br> 아래는 사용자가 앱을 어떻게 사용하는지 흐름을 나타낸 'user flow'이다.![user flow](https://github.com/user-attachments/assets/d2616eec-40f6-47fe-910c-b900e217a13d) <br> |
| (2) 전체 시스템 구성 | <img src="https://github.com/user-attachments/assets/affb9283-a3a0-4db9-8a52-6d58fa1928ea" width="90%" height="90%"/><br> **1. 클라이언트**<br> - `Flutter`: 클라이언트 개발 프레임워크로 사용<br> 1) 보호자(자녀): Flutter를 통해 보호자가 회원 정보 입력, 자가진단 및 리포트 조회 등의 기능을 사용할 수 있도록 함<br>  2) 사용자(노인): Flutter를 통해 음성 입력, 일기 생성 및 조회, 자가진단 및 기억 점수 테스트 등의 상호작용을 제공<br><br> **2. 서버**<br> 1) `Amazon EC2`<br> - 서버의 호스팅 및 확장 가능한 클라우드 컴퓨팅 인프라로 사용<br> 2) `Node.js`<br> - 일기 생성: 사용자와의 대화를 바탕으로 일기 생성<br> - 기억 점수 테스트: 지난 3일의 일기 내용을 바탕으로 생성한 문항들로 사용자에게 기억 점수 테스트를 실시<br> - 리포트 생성: 사용자와의 대화 내용을 바탕으로 사용자의 컨디션, 감정 분석 결과 등을 리포트로 제공<br> 3) `Flask`<br> - KoBERT에서 사용자의 일기를 전달받은 후 감정 분석을 진행하기 위한 서버<br> 4) `Firebase Cloud Messaging`: 사용자에게 정기적으로 일기 작성을 위한 대화를 권하는 알려주는 기능<br><br> **3. Database**<br> - `MongoDB`: 일기 데이터, 사용자 정보, 테스트 결과 등을 저장하는 비관계형(NoSQL) 데이터베이스로 사용<br><br>**4. API**<br> - `CLOVA Speech Recognition(CSR)`: 챗봇과 사용자의 대화 중 사용자의 음성을 챗봇에게 텍스트 형태로 전달 <br> - `Googe Text-to-Speech`: 챗봇과 사용자의 대화 중 챗봇의 응답을 사용자에게 음성의 형태로 전달<br> - `GPT-4o`: 사용자에게 할 질문, 응답 및 일기 생성<br><br> **5. Model**<br> - `SKT Brain KoBERT`: SKT Brain에서 제공하는 BERT 기반 한국어 모델로, 사용자의 일기를 분석하여 상위 감정 3개를 추출하는 데 사용 |
| (3) 진척도 및 검증내역 | **1. 프롬프트 엔지니어링** <br> - **기술 진척도: 100%** ⇒ 프롬프트 작성 완료 <br> - 스타트 단계에서 작성했던 프롬프트보다 친근한 대화를 위해 챗봇(소담)에 성격을 부여하고, 서비스 목적과 거리가 있는 ‘자녀에게 하고 싶은 말’ 제외. <br> - 질문의 최소, 최대 개수 지정하여 충분한 대화 유도. <br> - 사용자와의 충분한 대화를 통해 '오늘의 일기'와 '건강 상태'를 생성하고, 사용자가 자연스럽게 떠올릴 수 있도록 대화 유도. <br> - *일기 생성용 프롬프트 확인*: https://platform.openai.com/playground/p/4xwMRkvNGA6j28Lm9vszhJPb?model=undefined&mode=chat <br> - 프롬프트를 백엔드 코드와 통합하면서 발생했던 파싱 문제, 로직 문제 해결을 위해 수정 사항 반영. <br> - 기억 점수 측정을 위한 기준 정립 및 프롬프트 작성 완료.  <br> - 기억 점수 측정을 위한 필수 질문 개수 지정, CDR 기억 점수 출력 구현.  <br> - *기억점수 측정용 프롬프트 확인*: https://platform.openai.com/playground/chat?models=gpt-4o&preset=WaYRDChfZJhjIActqm1DOroE <br> <br> **2. 감정 분석** <br> - **기술 진척도: 100%** ⇒ 구현 완료 <br> - KoBERT를 활용하여 생성된 일기에 대한 감정 분석 완료. <br> - 감성 대화 말뭉치 및 대화 음성 데이터셋을 활용하여 KoBERT 모델로 감정 분류. <br> - 감정 분류 결과는 불안, 당황, 분노, 슬픔, 일상, 행복, 혐오 7개로 구분. <br> - 감정분석 코드: https://github.com/EWHA-DraWings/Submit/blob/main/%EC%86%8C%EB%8B%B4_%EA%B0%90%EC%A0%95%EB%B6%84%EC%84%9D.ipynb <br> <br> **3. 음성 대화용 STT&TTS 및 웹소켓 통신** <br> - **기술 진척도: 80%** ⇒ 프론트와 연결만 남은 상태로 BE에서는 작동 확인. <br> - Google Cloud TTS와 Naver Clova STT를 사용하여 음성 대화를 구현. <br> - 지연 없는 대화를 위해 웹소켓 방식으로 통신 구현 완료. |
| (4) 기타 | *기타 사항을 기술* |
<br>
